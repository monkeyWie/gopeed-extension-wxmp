(()=>{"use strict";gopeed.events.onResolve(async function(ctx){global.__gopeed_setFingerprint("chrome");var res=await fetch(ctx.req.url),html=await res.text(),videoMatch=html.match(/videoPageInfos\s+=\s+(\[[^]*\]);\nwindow\.__videoPageInfos\s=\svideoPageInfos/);if(!videoMatch)throw new MessageError("没有获取到视频信息");var videoInfos=eval(videoMatch[1]);gopeed.logger.debug("videoInfos",JSON.stringify(videoInfos));var titleMatch=html.match(/<meta\s+property="og:title"\s+content="([^"]*)"\s*\/?>/i),title=titleMatch?titleMatch[1]:"公众号视频";gopeed.logger.debug("title",title),ctx.res={name:title,files:videoInfos.map(function(e,t){var o=e.mp_video_trans_info[0];return{name:"".concat(title,"_").concat(t+1,".mp4"),size:o.filesize,req:{url:o.url.replace("http://","https://").replaceAll("&amp;","&")+"&vid=".concat(e.video_id,"&format_id=").concat(o.format_id,"&support_redirect=0&mmversion=false"),extra:{header:{Referer:"https://mp.weixin.qq.com/"}}}}})}})})();